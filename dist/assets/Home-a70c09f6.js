import{C as v}from"./CardList-99d436e7.js";import{_ as g,s as h,o as d,c as a,a as i,t as S,r as u,F as P,b as C,d as _,e as k,w as p,v as f}from"./index-74fe4696.js";const $={props:{id:{type:Number},edited:{type:Boolean,default:!1},title:{type:String,default:"Ma playlist"},image:{type:String,default:"none"},songs:{type:Array,default:[]}},computed:{toBodyRequest(){return{id:this.id,edited:this.edited,title:this.title,image:this.image,songs:this.songs,toJSON(){return delete this.edited,this}}}},methods:{updateTitle(t){this.toBodyRequest.title=t.target.value,this.$emit("updateTitle",this.toBodyRequest)}},data(){return{store:h}}},T=["data-id"],x=["src"],B={class:"inline-card__title"},L=i("i",{class:"material-symbols-outlined"},"delete",-1),E=["data-id"],F=["src"],R=["value"];function b(t,e,s,c,r,l){return s.edited?(d(),a("div",{key:1,"data-id":s.id,class:"inline-card"},[i("img",{src:s.image,class:"inline-card__img"},null,8,F),i("input",{type:"text",class:"inline-card__title",value:s.title,onChange:e[2]||(e[2]=(...o)=>l.updateTitle&&l.updateTitle(...o))},null,40,R),i("i",{class:"material-symbols-outlined",onClick:e[3]||(e[3]=o=>t.$emit("toggleEdit",this.toBodyRequest))},"done")],8,E)):(d(),a("div",{key:0,"data-id":s.id,class:"inline-card",onClick:e[1]||(e[1]=(...o)=>t.addSong&&t.addSong(...o))},[i("img",{src:s.image,class:"inline-card__img"},null,8,x),i("p",B,S(s.title),1),i("i",{class:"material-symbols-outlined",onClick:e[0]||(e[0]=o=>t.$emit("toggleEdit",this.toBodyRequest))},"edit"),L],8,T))}const I=g($,[["render",b]]),N={data(){return{store:h,localPlaylists:[]}},computed:{existingPlaylists(){return this.store.list.playlist.items.concat(this.localPlaylists)}},methods:{addLocalPlaylist(t={id:Date.now(),edited:!0}){this.localPlaylists.push(t)},toggleEdit(t){const e=this.store.list.playlist.items.find(s=>s.id===t.id);e.edited=!e.edited,e.edited||this.upsertPlaylist(t)},updateTitle(t){this.upsertPlaylist(t)},upsertPlaylist(t){let e=this.store.list.playlist.items.findIndex(s=>s.id===t.id);if(e===-1){this.store.list.playlist.items.push(t);let s=this.localPlaylists.findIndex(c=>c.id===t.id);this.localPlaylists.splice(s,1)}else this.store.list.playlist.items[e]=t;console.log(this.store.list.playlist.items),localStorage.setItem("playlists",JSON.stringify(this.store.list.playlist.items))},addSong(t){t.target.className.includes("inline-card")&&(this.songs.some(e=>e.id===this.store.clickedSong.id)||(this.songs.push(this.store.clickedSong),this.upsertPlaylist()),this.store.hideForm())}},components:{InlineCard:I},mounted(){for(const t in this.localPlaylists)this.addLocalPlaylist(t)}},w={class:"form-playlist"},q=i("h1",{class:"form-playlist__title"},"Enregistrer dans",-1),V={key:0,class:"form-playlist__list"};function A(t,e,s,c,r,l){const o=u("InlineCard");return d(),a("div",w,[i("span",{class:"material-symbols-outlined form-playlist__close",onClick:e[0]||(e[0]=n=>r.store.hideForm())}," close "),q,l.existingPlaylists.length>0?(d(),a("ul",V,[(d(!0),a(P,null,C(l.existingPlaylists,n=>(d(),a("li",null,[_(o,{id:n.id,title:n.title,edited:n.edited,songs:n.song,image:n.image,onToggleEdit:l.toggleEdit,onUpdateTitle:l.updateTitle},null,8,["id","title","edited","songs","image","onToggleEdit","onUpdateTitle"])]))),256))])):k("",!0),i("i",{class:"form-playlist__add material-symbols-outlined",onClick:e[1]||(e[1]=n=>l.addLocalPlaylist())}," add ")])}const J=g(N,[["render",A]]),O={name:"App",data(){return{store:h}},components:{CardList:v,PlaylistForm:J},async created(){await this.store.initialize()}},U={class:"container"},z={class:"container__lists"},H={class:"container__lists__item"};function M(t,e,s,c,r,l){const o=u("PlaylistForm"),n=u("CardList");return d(),a("main",U,[p(_(o,null,null,512),[[f,r.store.showPlaylistForm]]),i("ul",z,[(d(!0),a(P,null,C(r.store.list,(m,y)=>(d(),a("li",H,[p(_(n,{detailRoute:m.detailRoute,name:y,isSongList:y==="songs",title:m.title,cards:m.items},null,8,["detailRoute","name","isSongList","title","cards"]),[[f,m.items.length>0]])]))),256))])])}const K=g(O,[["render",M]]);export{K as default};
